From c826a1b8276879c6e3de384b697d42eadfcdf127 Mon Sep 17 00:00:00 2001
From: Kohsuke Kawaguchi <kk@kohsuke.org>
Date: Sat, 7 Mar 2015 09:35:28 -0800
Subject: [PATCH] [FIXED SECURITY-180]

---
 core/src/main/java/jenkins/security/ApiTokenProperty.java | 1 +
 1 file changed, 1 insertion(+)

diff --git a/core/src/main/java/jenkins/security/ApiTokenProperty.java b/core/src/main/java/jenkins/security/ApiTokenProperty.java
index caa9ed8853c..124d8bd78f8 100644
--- a/core/src/main/java/jenkins/security/ApiTokenProperty.java
+++ b/core/src/main/java/jenkins/security/ApiTokenProperty.java
@@ -81,6 +81,7 @@ public boolean matchesPassword(String password) {
     }
 
     public void changeApiToken() throws IOException {
+        user.checkPermission(Jenkins.ADMINISTER);
         _changeApiToken();
         if (user!=null)
             user.save();