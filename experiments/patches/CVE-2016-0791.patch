From 559566b1ac62ebe966613933baf1714137daeb8c Mon Sep 17 00:00:00 2001
From: Daniel Beck <daniel-beck@users.noreply.github.com>
Date: Tue, 26 Jan 2016 22:38:40 +0100
Subject: [PATCH] [FIX SECURITY-245] Compare crumbs in constant time

---
 core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java b/core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java
index b801866fa67..3db25892ab6 100644
--- a/core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java
+++ b/core/src/main/java/hudson/security/csrf/DefaultCrumbIssuer.java
@@ -95,7 +95,7 @@ public boolean validateCrumb(ServletRequest request, String salt, String crumb)
         if (request instanceof HttpServletRequest) {
             String newCrumb = issueCrumb(request, salt);
             if ((newCrumb != null) && (crumb != null)) {
-                return newCrumb.equals(crumb);
+                return MessageDigest.isEqual(newCrumb.getBytes(), crumb.getBytes());
             }
         }
         return false;